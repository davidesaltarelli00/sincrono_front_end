<html>
<head>
  <title>
    lista anagrafica
  </title>
</head>
<style>
  .sidebar {
    width: 250px;
    background-color: #333;
    color: #ffffff;
    height: 200vh;
    position: inherit;
  }

  /* Stile delle voci di menu nella sidebar */
  .sidebar-item {
    padding: 10px 20px;
    border-bottom: 1px solid #ffffff;
  }

  .sidebar-item:last-child {
    border-bottom: none;
  }

  .sidebar-link {
    text-decoration: none;
    color: #ffffff;
  }

  .sidebar-link:hover {
    color: #d8d8d8;
  }

  .content {
    flex: 1;
    padding: 20px;
  }

  .navbar {
    padding: 10px 20px;
  }

  .navbar-brand {
    font-weight: bold;
  }

  .navbar-nav {
    margin-left: auto;
  }

  .nav-link {
    color: #ffffff;
    text-decoration: none;
    margin-left: 10px;
  }

  .nav-link:hover {
    color: #d8d8d8;
  }

  .login-page .sidebar {
    display: none;
  }

  .example-container {
   width: 100%;
    height: 100%;
  }

  .spacer {
    flex: 1 1 auto;
  }

  mat-drawer{
    background-color: #333;
  }

  p{
    cursor: pointer;
  }

  mat-icon-button:hover{
  background-color: none;
  }

  mat-toolbar{
    background-color: #333;
    color: white;
  }


  </style>
<body > <!--style="padding-top: 50px;"-->

    <!--div *ngIf="showErrorPopup" class="alert alert-danger" role="alert">
        Si è verificato un errore.
        <button (click)="chiudiPopup()" class="close" aria-label="Chiudi">
          <span aria-hidden="true">&times;</span>
        </button>
      </!--div>

      <div-- *ngIf="showSuccessPopup" class="alert alert-success" role="alert">
        Operazione completata con successo.
        <button (click)="chiudiPopup()" class="close" aria-label="Chiudi">
          <span aria-hidden="true">&times;</span>
        </button>
      </div-->




      <mat-toolbar>
        <a [routerLink]="['/home']" style="margin:5px; text-align: center;" > <img style="margin:5px; text-align: center;" width="40" height="40" src="../../../../assets/images/logo.jpeg" alt="Logo"> </a>
        <span> Sincrono CRM <button (click)="drawer.toggle()" mat-flat-button style="background-color: transparent; color: black;" > <mat-icon style="color: #ffffff;" >menu</mat-icon> </button> </span>
        <span class="spacer"></span>
        <span style="cursor: pointer;" id="icona" mat-icon-button [routerLink]="['/login']" (click)="logout()" >
          <mat-icon>logout</mat-icon>
        </span>
      </mat-toolbar>
      <mat-drawer-container autosize class="example-container" >
        <mat-drawer #drawer class="example-sidenav" mode="side" opened>
          <div class="profile-box" (click)="profile()" style="text-align: center;
          color: white;
          font-weight: 400;
          border-bottom: 1px solid #f2f2f2; margin:auto;">
            <mat-icon>account_circle</mat-icon> <br>
            <p>{{userlogged}}</p>
          </div>
          <nav>
            <ul class="list-unstyled">
              <li class="sidebar-item">
                <p class="sidebar-link" [routerLink]="['/lista-anagrafica']">Lista anagrafiche</p>
              </li>
              <mat-divider></mat-divider>
              <li class="sidebar-item">
                <p class="sidebar-link" [routerLink]="['/dashboard']">Dashboard</p>
              </li>
              <mat-divider></mat-divider>
              <li class="sidebar-item">
                <p class="sidebar-link" [routerLink]="['/organico']">Organico</p>
              </li>
              <mat-divider></mat-divider>
            </ul>
          </nav>
        </mat-drawer>
        <mat-drawer-content>
          <div class="container-fluid">
            <div class="row">
              <div class="col-12">
                <h1>Lista Anagrafiche</h1>
              </div>
            </div>



            <button class="btn btn-success" style="background-color: rgb(24, 122, 0); color: white;"
            [routerLink]="['/nuova-anagrafica']">Inserisci Nuova Anagrafica</button> <!--dark btn-sm rounded-pill shadow-sm-->
        <br>
        <br>

        <mat-expansion-panel>
          <mat-expansion-panel-header (click)="mostraFiltri = !mostraFiltri">

                {{ mostraFiltri ? 'Nascondi filtri' : 'Mostra filtri' }}
               </mat-expansion-panel-header>

          <ng-template matExpansionPanelContent>
            <div *ngIf="mostraFiltri">
              <form [formGroup]="filterAnagraficaDto" (ngSubmit)="filter()">
                  <div class="container">
                      <div formGroupName="anagrafica">
                          <div class="row">
                              <div class="col-md-3">
                                <div class="form-group" >
                                  <label for="filter-name">Nome:</label>
                                  <input type="text" id="filter-Nome" class="form-control" formControlName="nome">
                                </div>

                              </div>
                              <div class="col-md-3">
                                <div class="form-group" >
                                  <label for="filter-name">Cognome:</label>
                                  <input type="text" id="filter-Nome" class="form-control" formControlName="cognome">
                                </div>

                              </div>
                              <div class="col-md-3">
                                <div class="form-group" >
                                  <label for="filter-name">Tipo Azienda:</label>
                                  <input type="text" id="filter-Nome" class="form-control" formControlName="aziendaTipo">
                                </div>

                              </div>
                              <div class="col-md-3">
                                <div class="form-group" >
                                  <input class="form-check-input" type="checkbox" id="exampleCheckbox"
                                  formControlName="attivo">
                              <label class="form-check-label" for="exampleCheckbox">
                                  Attivo
                              </label>
                                </div>

                              </div>
                          </div>
                      </div>

                      <div formGroupName="commessa">
                          <div class="row">
                              <div class="col-md-3">
                                  <label for="filter-name">Nominativo:</label>
                                  <input type="text" id="filter-Nome" class="form-control" formControlName="nominativo">
                              </div>
                              <div class="col-md-3">
                                  <label for="filter-name">Cliente:</label>
                                  <input type="text" id="filter-Nome" class="form-control" formControlName="cliente">
                              </div>
                              <div class="col-md-3">
                                  <label for="filter-name">Azienda:</label>
                                  <input type="text" id="filter-Nome" class="form-control" formControlName="azienda">
                              </div>
                          </div>
                      </div>
                      <div formGroupName="contratto">
                          <div class="row">
                              <div class="col-md-3">
                                  <label for="filter-name">ralAnnua:</label>
                                  <input type="text" id="filter-Nome" class="form-control" formControlName="ralAnnua">
                              </div>
                              <div class="col-md-3">
                                  <label for="dataAssunzione">Data Assunzione</label>
                                  <mat-form-field appearance="outline">
                                      <input matInput [matDatepicker]="picker" formControlName="dataAssunzione"
                                          placeholder="Inserisci la data di assunzione" class="form-control"
                                          formControlName="dataAssunzione" />
                                      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                      <mat-datepicker #picker></mat-datepicker>
                                  </mat-form-field>
                              </div>
                              <div class="col-md-3">
                                  <label for="dataFineRapporto">Data Fine Rapporto</label>
                                  <mat-form-field appearance="outline">
                                      <input matInput [matDatepicker]="picker1" formControlName="dataFineRapporto"
                                          placeholder="Inserisci la data di fine rapporto" class="form-control"
                                          formControlName="dataFineRapporto" />
                                      <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                      <mat-datepicker #picker1></mat-datepicker>
                                  </mat-form-field>
                              </div>
                          </div>
                          <div class="row">
                              <div class="col-md-3">
                                  <div formGroupName="tipoContratto">
                                      <label for="filter-TipoContratto">Tipo Contratto:</label>
                                      <select class="form-control" id="tipoContratto" formControlName="descrizione">
                                          <option value="">--nessuna selezione--</option>
                                          <option *ngFor="let tipoContratto of tipiContratti"
                                              value="{{tipoContratto.descrizione}}">
                                              {{tipoContratto.descrizione}}</option>
                                      </select>
                                  </div>
                              </div>
                              <div class="col-md-3">
                                  <div formGroupName="contrattoNazionale">

                                      <label for="filter-Tipo Contratto nazionale">Tipo Contratto nazionale:</label>
                                      <select class="form-control" id="tipoContrattoNazionale" formControlName="descrizione">
                                          <option value="">--nessuna selezione--</option>
                                          <option *ngFor="let contrattiNazionale of contrattiNazionali"
                                              value="{{contrattiNazionale.descrizione}}" formControlName="descrizione">
                                              {{contrattiNazionale.descrizione}}</option>
                                      </select>
                                  </div>
                              </div>
                              <div class="col-md-3">
                                  <div formGroupName="tipoAzienda">
                                      <label for="filter-Tipo Azienda">Tipo Azienda:</label>
                                      <select class="form-control" id="tipoAzienda" formControlName="descrizione" type="number">
                                          <option value="">--nessuna selezione--</option>
                                          <option *ngFor="let tipoAzienda of tipiAziende" value="{{tipoAzienda.descrizione}}">
                                              {{tipoAzienda.descrizione}}</option>
                                      </select>
                                  </div>
                              </div>
                              <br>
                              <div class="row">
                                  <div class="col-md-3">
                                    <br>
                                      <button id="filter-Button" class="btn btn-success"
                                          style="background-color: rgb(24, 122, 0); color: white;">Filtra</button> &nbsp; <!--dark btn-sm rounded-pill shadow-sm-->
                                      <button (click)="annullaFiltri()" id="filter-Button"
                                          class="btn btn-info">Annulla filtri </button>
                                  </div> <!--dark btn-sm rounded-pill shadow-sm  style="background-color: rgb(24, 122, 0); color: white;"-->
                              </div>
                          </div>
                      </div>
                  </div>
              </form>
          </div>      </ng-template>
        </mat-expansion-panel>
        <br>

        <div class="row">
          <div class="col-12">
            <div class="table-responsive">
              <table id="table" class="table table-striped table-bordered">
                  <thead class="thead-dark">
                      <tr>
                          <th scope="col">Nome</th>
                          <th scope="col">Cognome</th>
                          <th scope="col">Codice Fiscale</th>
                          <th scope="col">Dettaglio</th>
                          <th scope="col">Elimina</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr *ngFor="let element of lista">
                          <td>{{ element?.anagrafica.nome }}</td>
                          <td>{{ element?.anagrafica.cognome }}</td>
                          <td>{{ element?.anagrafica.codiceFiscale }}</td>
                          <td>
                              <a [routerLink]="['/dettaglio-anagrafica', element?.anagrafica.id]"><img
                                      src="../../../../assets/images/dettagli.png" height="30px" width="45px"></a>
                          </td>
                          <td>
                              <button class="btn btn-danger"
                                  (click)="delete(element?.anagrafica.id,element?.contratto.id,element?.commessa.id)">Elimina</button>
                          </td>
                      </tr>
                  </tbody>

              </table>
          </div>
          </div>
        </div>


          </div>
          <!-- <footer>
            <p>© 2023 CRM Company. Tutti i diritti riservati.</p>
          </footer> -->
        </mat-drawer-content>

      </mat-drawer-container>

<script>
   const userLogged = localStorage.getItem('userLogged');
         if (userLogged) {
           console.log("Utente loggato constructor: "+ this.userlogged)
           this.userlogged = userLogged;
         }
</script>

</body>

</html>
