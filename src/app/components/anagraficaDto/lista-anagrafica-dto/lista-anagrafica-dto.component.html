<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <h1>Lista Anagrafiche</h1>
    </div>
  </div>



  <button class="btn btn-success" style="background-color: rgb(24, 122, 0); color: white;"
  [routerLink]="['/nuova-anagrafica']">Inserisci Nuova Anagrafica <i class="fa fa-plus"></i> </button> <!--dark btn-sm rounded-pill shadow-sm-->
<br>
<br>

<mat-expansion-panel>
<mat-expansion-panel-header (click)="mostraFiltri = !mostraFiltri">

      {{ mostraFiltri ? 'Nascondi filtri' : 'Mostra filtri' }}
     </mat-expansion-panel-header>

<ng-template matExpansionPanelContent>
  <div *ngIf="mostraFiltri">
    <form [formGroup]="filterAnagraficaDto" (ngSubmit)="filter()">
        <div class="container">
            <div formGroupName="anagrafica">
                <div class="row">
                    <div class="col-md-3">
                      <div class="form-group" >
                        <label for="filter-name">Nome:</label>
                        <input type="text" id="filter-Nome" class="form-control" formControlName="nome">
                      </div>

                    </div>
                    <div class="col-md-3">
                      <div class="form-group" >
                        <label for="filter-name">Cognome:</label>
                        <input type="text" id="filter-Nome" class="form-control" formControlName="cognome">
                      </div>

                    </div>
                    <div class="col-md-3">
                      <div class="form-group" >
                        <label for="filter-name">Tipo Azienda:</label>
                        <input type="text" id="filter-Nome" class="form-control" formControlName="aziendaTipo">
                      </div>

                    </div>
                    <div class="col-md-3">
                      <div class="form-group" >
                        <input class="form-check-input" type="checkbox" id="exampleCheckbox"
                        formControlName="attivo">
                    <label class="form-check-label" for="exampleCheckbox">
                        Attivo
                    </label>
                      </div>

                    </div>
                </div>
            </div>

            <div formGroupName="commessa">
                <div class="row">
                    <div class="col-md-3">
                        <label for="filter-name">Nominativo:</label>
                        <input type="text" id="filter-Nome" class="form-control" formControlName="nominativo">
                    </div>
                    <div class="col-md-3">
                        <label for="filter-name">Cliente:</label>
                        <input type="text" id="filter-Nome" class="form-control" formControlName="cliente">
                    </div>
                    <div class="col-md-3">
                        <label for="filter-name">Azienda:</label>
                        <input type="text" id="filter-Nome" class="form-control" formControlName="azienda">
                    </div>
                </div>
            </div>
            <div formGroupName="contratto">
                <div class="row">
                    <div class="col-md-3">
                        <label for="filter-name">ralAnnua:</label>
                        <input type="text" id="filter-Nome" class="form-control" formControlName="ralAnnua">
                    </div>
                    <div class="col-md-3">
                        <label for="dataAssunzione">Data Assunzione</label>
                        <mat-form-field appearance="outline">
                            <input matInput [matDatepicker]="picker" formControlName="dataAssunzione"
                                placeholder="Inserisci la data di assunzione" class="form-control"
                                formControlName="dataAssunzione" />
                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-datepicker #picker></mat-datepicker>
                        </mat-form-field>
                    </div>
                    <div class="col-md-3">
                        <label for="dataFineRapporto">Data Fine Rapporto</label>
                        <mat-form-field appearance="outline">
                            <input matInput [matDatepicker]="picker1" formControlName="dataFineRapporto"
                                placeholder="Inserisci la data di fine rapporto" class="form-control"
                                formControlName="dataFineRapporto" />
                            <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                            <mat-datepicker #picker1></mat-datepicker>
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3">
                        <div formGroupName="tipoContratto">
                            <label for="filter-TipoContratto">Tipo Contratto:</label>
                            <select class="form-control" id="tipoContratto" formControlName="descrizione">
                                <option value="">--nessuna selezione--</option>
                                <option *ngFor="let tipoContratto of tipiContratti"
                                    value="{{tipoContratto.descrizione}}">
                                    {{tipoContratto.descrizione}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div formGroupName="tipoCcnl">
                            <label for="filter-TipoCcnl">Tipo Contratto Nazionale:</label>
                            <select class="form-control" id="tipoCcnl" formControlName="descrizione" type="number">
                                <option value="">--nessuna selezione--</option>
                                <option *ngFor="let tipoCcnl of tipiCcnl" value="{{tipoCcnl.descrizione}}">
                                    {{tipoCcnl.descrizione}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div formGroupName="tipoAzienda">
                            <label for="filter-TipoAzienda">Tipo Azienda:</label>
                            <select class="form-control" id="tipoAzienda" formControlName="descrizione" type="number">
                                <option value="">--nessuna selezione--</option>
                                <option *ngFor="let tipoAzienda of tipiAziende" value="{{tipoAzienda.descrizione}}">
                                    {{tipoAzienda.descrizione}}</option>
                            </select>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-md-3">
                          <br>
                            <button id="filter-Button" class="btn btn-success"
                                style="background-color: rgb(24, 122, 0); color: white;">Filtra</button> &nbsp; <!--dark btn-sm rounded-pill shadow-sm-->
                            <button (click)="annullaFiltri()" id="filter-Button"
                                class="btn btn-info">Annulla filtri </button>
                        </div> <!--dark btn-sm rounded-pill shadow-sm  style="background-color: rgb(24, 122, 0); color: white;"-->
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>      </ng-template>
</mat-expansion-panel>
<br>

<div class="row">
<div class="col-12">
  <div class="table-responsive">
    <table id="table" class="table table-striped table-bordered">
      <thead class="thead-dark">
        <tr>
          <th scope="col">Inserimento parziale</th>
          <th scope="col">Nome</th>
          <th scope="col">Cognome</th>
          <th scope="col">Codice Fiscale</th>
          <th scope="col">Nome azienda</th>
          <th scope="col">Mail aziendale</th>
          <th scope="col">Cell privato</th>
          <th scope="col" >Contratto</th>
          <th scope="col">Azioni</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let element of pageData">
          <td [routerLink]="['/dettaglio-anagrafica/',element.anagrafica.id]" >
            <div>
              <span [ngClass]="{'text-danger': isCampoVuoto(element), 'text-success': !isCampoVuoto(element)}">
                {{ isCampoVuoto(element) ? 'Si' : 'No' }}
              </span>
            </div>
          </td>
          <td>{{ element.anagrafica?.nome |titlecase }}</td>
          <td>{{ element.anagrafica?.cognome |titlecase }}</td>
          <td>{{ element.anagrafica?.codiceFiscale |uppercase }}</td>
          <td>{{ element.anagrafica?.tipoAzienda?.descrizione |titlecase }}</td>
          <td>{{ element.anagrafica?.mailAziendale  }}</td>
          <td>{{ element.anagrafica?.cellularePrivato ? element.anagrafica.cellularePrivato: 'Non presente'  }}</td>
          <td *ngIf="element.contratto?.tipoContratto?.descrizione!='#'">
            {{element.contratto?.tipoContratto?.descrizione ? element.contratto?.tipoContratto?.descrizione : 'Non inserito'}}
          </td>
          <td *ngIf="element.contratto?.tipoContratto?.descrizione==='#'" >
            Generico
          </td>
          <td>
            <span style="margin:5px;">
              <a [routerLink]="['/dettaglio-anagrafica', element?.anagrafica.id]"><button class="btn btn-info"><i class="fa fa-info"></i></button></a>
            </span>
            <span style="margin:5px;">
              <button class="btn btn-warning" [routerLink]="['/modifica-anagrafica', element.anagrafica.id]"><i class="fa fa-pencil"></i></button>
            </span>
            <span style="margin:5px;" *ngIf="element.anagrafica.attivo==true">
              <button class="btn btn-danger" matTooltip="Disattiva anagrafica" (click)="elimina(element.anagrafica.id)"><i class="fa fa-minus"></i></button>
            </span>
            <span style="margin:5px;" *ngIf="element.anagrafica.attivo==false">
              <button class="btn btn-success"  (click)="riattivaAnagrafica(element.anagrafica.id)" matTooltip="Riattiva anagrafica" > <i class="fa fa-plus" ></i> </button>
            </span>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="pagination">
      <ul>
        <li [class.disabled]="currentPage === 1" (click)="goToPage(currentPage - 1)">
          <span> <i class="fa fa-arrow-left" ></i> </span>
        </li>
        <li *ngFor="let page of getPaginationArray()" [class.active]="currentPage === page" (click)="goToPage(page)">
          <span>{{ page }}</span>
        </li>
        <li [class.disabled]="currentPage === getTotalPages()" (click)="goToPage(currentPage + 1)">
          <span> <i class="fa fa-arrow-right" ></i> </span>
        </li>
      </ul>
    </div>

</div>
</div>
</div>


</div>
