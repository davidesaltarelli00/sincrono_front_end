<html>
  <head>
    <style>


  .pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 20px;
  }

  .pagination ul {
    list-style: none;
    padding: 0;
    display: flex;
    align-items: center;
  }

  .pagination li {
    margin: 0 5px;
    cursor: pointer;
    padding: 5px 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    transition: background-color 0.3s, color 0.3s;
  }

  .pagination li.disabled {
    pointer-events: none;
    background-color: #f5f5f5;
    color: #ccc;
    border: 1px solid #ccc;
  }

  .pagination li.active {
    background-color: #007bff;
    color: #fff;
    border: 1px solid #007bff;
  }

  .pagination li:hover {
    background-color: #ccc;
    color: #333;
    border: 1px solid #333;
  }

    </style>
  </head>
  <body>
    <div class="container-fluid">
      <header>
        <h1>Dashboard</h1>
      </header>
      <main>
        <div class="table-responsive">
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <h4>Contratti Scatto Livello</h4>
            </mat-expansion-panel-header>

            <ng-template matExpansionPanelContent>
              <table id="table" class="table table-striped table-bordered">
                <thead class="thead-dark">
                  <tr>
                    <th scope="col">nome</th>
                    <th scope="col">cognome</th>
                    <th scope="col">codice fiscale</th>
                    <th scope="col">Data Assunzione</th>
                    <th scope="col">ccnl</th>
                    <th scope="col">descrizione</th>
                    <th scope="col">minimo retribuzione</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container *ngFor="let element of data">
                    <tr>
                      <td>{{ element.anagrafica.nome }}</td>
                      <td>{{ element.anagrafica.cognome }}</td>
                      <td>{{ element.anagrafica.codiceFiscale }}</td>
                      <td>{{ element.contratto.dataAssunzione }}</td>
                      <td>{{ element.contratto.livelloContratto.ccnl }}</td>
                      <td>
                        {{ element.contratto.livelloContratto.livello }}
                      </td>
                      <td>
                        {{ element.contratto.livelloContratto.minimiRet23 }}
                      </td>
                    </tr>
                  </ng-container>
                </tbody>
                <button (click)="resetTabella()" class="btn btn-success">
                  reset tabella
                </button>
              </table>
            </ng-template>
          </mat-expansion-panel>
          <!-- <button (click)="toggleTable1()" class="btn btn-success" > {{ isTableVisible1 ? 'Nascondi' : 'Espandi' }}</button> -->
        </div>

        <div class="table-responsive">
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <h4>Contratti in Scadenza (40 giorni)</h4>
            </mat-expansion-panel-header>

            <ng-template matExpansionPanelContent>
              <table id="table" class="table table-striped table-bordered">
                <!--*ngIf="isTableVisible"-->
                <thead class="thead-dark">
                  <tr>
                    <th scope="col">Nominativo</th>
                    <th scope="col">Data Assunzione</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container *ngFor="let data of lista">
                    <tr
                      *ngIf="
                        this.scadenzaContratti40Giorni(
                          data.contratto.dataAssunzione,
                          data.contratto.mesiDurata
                        )
                      "
                    >
                      <td>{{ data.commessa.nominativo }}</td>
                      <td>
                        {{ this.transformDate(data.contratto.dataAssunzione) }}
                      </td>
                    </tr>
                  </ng-container>
                </tbody>
              </table>
            </ng-template>
          </mat-expansion-panel>

          <!-- <button (click)="toggleTable()" class="btn btn-success">  {{ isTableVisible ? 'Nascondi' : 'Espandi' }}</button> dark btn-sm rounded-pill shadow-sm" style="background-color: rgb(24, 122, 0); color: white; -->
        </div>
        <div class="table-responsive">
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <h4>Commesse in Scadenza (40 giorni)</h4>
            </mat-expansion-panel-header>

            <ng-template matExpansionPanelContent>
              <!-- <button (click)="toggleTable2()" class="btn btn-success" >  {{ isTable2Visible ? 'Nascondi' : 'Espandi' }}</button> dark btn-sm rounded-pill shadow-sm style="background-color: rgb(24, 122, 0); color: white;" -->
              <table id="table" class="table table-striped table-bordered">
                <!--*ngIf="isTable2Visible"-->
                <thead class="thead-dark">
                  <tr>
                    <th scope="col">Nominativo</th>
                    <th scope="col">Data Assunzione</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container
                    *ngFor="let data of lista; index as i; first as isFirst"
                  >
                    <tr
                      *ngIf="
                        this.scadenzaCommesse40Giorni(data.commessa.dataFine)
                      "
                    >
                      <td>{{ data.commessa.nominativo }}</td>
                      <td>
                        {{ this.transformDate(data.contratto.dataAssunzione) }}
                      </td>
                    </tr>
                  </ng-container>
                </tbody>
              </table>
            </ng-template>
          </mat-expansion-panel>
        </div>

        <div style="padding-top: 70px" class="table-responsive">
          <table class="table table-striped table-bordered">
            <thead class="thead-dark">
              <tr>
                <th scope="col">Nominativo</th>
                <th scope="col">Contratto</th>
                <th scope="col">Società</th>
                <th scope="col">Contratto Nazionale</th>
                <th scope="col">Data inizio</th>
                <th scope="col">Data fine</th>
                <th scope="col">Mesi durata</th>
                <th scope="col">1° Periodo</th>
                <th scope="col">2° Periodo</th>
                <th scope="col">3° Periodo</th>
                <th scope="col">Liv.att.</th>
                <th scope="col">Liv.fin.</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of getCurrentPageItems()">
                <td>{{ data.commessa.nominativo }}</td>
                <td>{{ data.contratto.tipoContratto.descrizione }}</td>
                <td>{{ data.contratto.tipoAzienda.descrizione }}</td>
                <td>{{ data.contratto.tipoCcnl.descrizione }}</td>
                <td>{{ this.transformDate(data.commessa.dataInizio) }}</td>
                <td>{{ this.transformDate(data.commessa.dataFine) }}</td>
                <td>{{ data.contratto.mesiDurata }}</td>

                <!---->
                <td>
                  <div
                    *ngIf="
                      this.calcolaScadenzaImminentePeriodo(
                        data?.contratto.dataAssunzione,
                        this.calcolaPeriodi(
                          data.contratto.mesiDurata,
                          data.contratto.tipoCcnl.descrizione
                        ),
                        this.data.contratto.tipoCcnl.descrizione
                      ) == true;
                      else elseBlock1
                    "
                  >
                    <div style="color: red">
                      {{
                        this.calcolaPeriodi(
                          data.contratto.mesiDurata,
                          data.contratto.tipoCcnl.descrizione
                        )
                      }}
                    </div>
                  </div>
                  <ng-template #elseBlock1>
                    {{
                      this.calcolaPeriodi(
                        data.contratto.mesiDurata,
                        data.contratto.tipoCcnl.descrizione
                      )
                    }}
                  </ng-template>
                </td>

                <td>
                  <div
                    *ngIf="
                      this.calcolaScadenzaImminentePeriodo2(
                        data?.contratto.dataAssunzione,
                        this.calcolaPeriodi(
                          data.contratto.mesiDurata,
                          data.contratto.tipoCcnl.descrizione
                        ),
                        this.data.contratto.tipoCcnl.descrizione
                      ) == true;
                      else elseBlock2
                    "
                  >
                    <div style="color: red">
                      {{
                        this.calcolaPeriodi(
                          data.contratto.mesiDurata,
                          data.contratto.tipoCcnl.descrizione
                        )
                      }}
                    </div>
                  </div>
                  <ng-template #elseBlock2>
                    {{
                      this.calcolaPeriodi(
                        data.contratto.mesiDurata,
                        data.contratto.tipoCcnl.descrizione
                      )
                    }}
                  </ng-template>
                </td>

                <td>
                  <div
                    *ngIf="
                      data.contratto.tipoCcnl.descrizione ==
                        'METALMECCANICO PMI CONFAPI';
                      else elseBlock3
                    "
                  >
                    <div
                      *ngIf="
                        this.calcolaScadenzaImminentePeriodo3(
                          data?.contratto.dataAssunzione,
                          this.calcolaPeriodi(
                            data.contratto.mesiDurata,
                            data.contratto.tipoCcnl.descrizione
                          )
                        ) == true;
                        else elseBlock4
                      "
                    >
                      <div style="color: red">
                        {{
                          this.calcolaPeriodi(
                            data.contratto.mesiDurata,
                            data.contratto.tipoCcnl.descrizione
                          )
                        }}
                      </div>
                    </div>
                  </div>

                  <ng-template #elseBlock3> </ng-template>
                  <ng-template #elseBlock4>
                    {{
                      this.calcolaPeriodi(
                        data.contratto.mesiDurata,
                        data.contratto.tipoCcnl.descrizione
                      )
                    }}
                  </ng-template>
                </td>
                <td>{{ data.contratto.livelloAttuale }}</td>
                <td>{{ data.contratto.livelloFinale }}</td>
              </tr>
            </tbody>
          </table>
          <div class="pagination"  >
            <ul>
              <li [class.disabled]="currentPage === 1" (click)="goToPage(currentPage - 1)">
                <span> <i class="fa fa-arrow-left" ></i> </span>
              </li>
              <li *ngFor="let page of getPaginationArray()" [class.active]="currentPage === page" (click)="goToPage(page)">
                <span>{{ page }}</span>
              </li>
              <li [class.disabled]="currentPage === getTotalPages()" (click)="goToPage(currentPage + 1)">
                <span> <i class="fa fa-arrow-right" ></i> </span>
              </li>
            </ul>
          </div>
        </div>
      </main>

    </div>
  </body>
</html>


