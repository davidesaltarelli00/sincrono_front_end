<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<style>
  .container-fluid {
    background-color: aliceblue;
  }

  body {
    background-color: aliceblue;
  }


  #toolbar {
    background-color: #007bff;
    /* Colore blu aziendale */
    color: #ffffff;
    /* Testo bianco */
    display: flex;
    background-color: #333;
    justify-content: space-between;
    /* Allinea gli elementi a sinistra e a destra */
    align-items: center;
    /* Allinea verticalmente gli elementi al centro */
  }

  .logo-link {
    margin-right: 10px;
  }

  .toolbar-menu {
    display: flex;
    gap: 10px;
    background-color: #333;
    margin-right: auto;
  }

  .toolbar-link {
    text-decoration: none;
    color: #ffffff;
    /* padding: 10px; */
  }

  a {
    color: white;
  }

  .toolbar-link:hover {
    color: #d8d8d8;
  }

  .user-icon,
  .logout-icon {
    color: #ffffff;
    cursor: pointer;
  }
</style>

<body [class.dark-mode]="themeService.isDarkModeEnabled()">
  <div id="inizioPagina"></div>
  <div class="container-toolbar" *ngIf="!mobile && jsonData?.list">
    <div class="row align-items-center">
      <div class="col-auto">
        <a [routerLink]="['/home']" class="logo-link">
          <img class="logo-image" width="40" height="40" src="../../../../assets/images/logo.jpeg" alt="Logo">
        </a>
      </div>

      <div class="col-auto">
        <button  *ngIf="getWindowWidth() < 830" mat-icon-button [matMenuTriggerFor]="hamburgerMenu" (click)="toggleHamburgerMenu()" class="hamburger-icon">
          <mat-icon>menu</mat-icon>
        </button>
      </div>

      <div class="col-auto">
        <mat-menu #hamburgerMenu="matMenu" class="hamburger-menu">
          <button id="menu-voice" mat-menu-item *ngFor="let menuItem of jsonData.list" (click)="navigateTo(menuItem.percorso)">
            {{ menuItem.nome }}
          </button>
        </mat-menu>

        <div class="toolbar-menu" *ngIf="jsonData && jsonData.list && !isHamburgerMenuOpen">
          <a (click)="getPermissions(menuItem.id)" style="color: white;" class="toolbar-link"
            *ngFor="let menuItem of jsonData.list" [routerLink]="[menuItem.percorso]">
            {{ menuItem.nome }}
          </a>
        </div>
      </div>

      <div class="col-auto" *ngIf="jsonData && jsonData.list && !isHamburgerMenuOpen">
        <a style="color:white; cursor: pointer;" (click)="vaiAlRapportino()">Rapportino</a>
      </div>

      <div class="col-auto">
        <div class="form-check form-switch" matTooltip="{{ themeService.isDarkModeEnabled() ? 'Light mode' : 'Dark Mode' }}">
          <input class="form-check-input" [checked]="themeService.isDarkModeEnabled()" (click)="toggleDarkMode()" type="checkbox" id="flexSwitchCheckDefault">
          <label class="form-check-label" for="flexSwitchCheckDefault" matTooltip="{{ themeService.isDarkModeEnabled() ? 'Light mode' : 'Dark Mode' }}"></label>
        </div>
      </div>

      <div class="col-auto">
        <div style="cursor: pointer;" mat-icon-button [routerLink]="['/profile-box']" class="user-icon">
          <small *ngIf="userRoleNav===false">{{userLoggedName}} {{userLoggedSurname}} (Admin) &nbsp;</small>
          <small *ngIf="userRoleNav===true">{{userLoggedName}} {{userLoggedSurname}} (Dipendente) &nbsp;</small>
          <i class="fa fa-user"></i>
        </div>
      </div>

      <div class="col-auto">
        <div style="cursor: pointer;" mat-icon-button (click)="logout()" class="logout-icon">
          <i class="fa fa-sign-out" aria-hidden="true"></i>
        </div>
      </div>
    </div>
  </div>

 <div class="container-toolbar" [hidden]="tokenProvvisorio != null && tokenProvvisorio == null">
    <mat-toolbar id="toolbar" *ngIf="token && mobile  && jsonData?.list">
      <a [routerLink]="['/home']" class="logo-link">
        <img class="logo-image" width="40" height="40" src="../../../../assets/images/logo.jpeg" alt="Logo">
      </a>
      <button style="background-color:#333;color:white;margin-left:-10px;margin-right:3px;border-radius:1px;padding:5px;"
        mat-icon-button [matMenuTriggerFor]="menu">
        <mat-icon>menu</mat-icon>
      </button>
      <mat-menu #menu="matMenu">
        <ng-template matMenuContent>
          <button  mat-menu-item *ngFor="let menuItem of jsonData.list"
            [routerLink]="[menuItem.percorso]" (click)="getPermissions(menuItem.id)">
            {{ menuItem.nome }}
          </button>
          <button mat-menu-item  (click)="vaiAlRapportino()">
            Rapportino
          </button>
        </ng-template>
      </mat-menu>

      <span style="cursor: pointer;" mat-icon-button [routerLink]="['/profile-box']" class="user-icon">
        <small *ngIf="userRoleNav===false">{{userLoggedName}} {{userLoggedSurname}} (Admin) &nbsp;</small>
        <small *ngIf="userRoleNav===true">{{userLoggedName}} {{userLoggedSurname}} (Dipendente) &nbsp;</small>
        <i class="fa fa-user"></i>
      </span> &nbsp;&nbsp;
      <span style="cursor: pointer;" mat-icon-button (click)="logout()" class="logout-icon">
        <i class="fa fa-sign-out" aria-hidden="true"></i>
      </span>
    </mat-toolbar>
  </div>

  <div class="container-fluid" *ngIf="ruolo==='ADMIN'" [class.dark-mode]="themeService.isDarkModeEnabled()">
    <div class="row">
      <div class="col-12">
        <br>
        <mat-card style="text-align: center;">
          <h1><img src="../../../../assets/images/logoSincronoCompleto.png" alt="Logo Sincrono"></h1>
          <h1>Lista rapportini <i class="fa fa-file"></i></h1>
        </mat-card>
      </div>
    </div>
    <br>
    <div class="row" style="margin: auto; text-align: center;">
      <div class="col-6" style="margin: auto; text-align: center;">
        <mat-card>
          <form>
            <div class="container">
              <div class="row">
                <div class="col-md-4">
                  <div class="form-group">
                    <label for="meseSelect">Mese:</label>
                    <select
                      (change)="onMeseSelectChange($event)"
                      class="form-select"
                      aria-label="Default select example"
                      id="meseSelect"
                      [(ngModel)]="selectedMese"
                      name="mese"
                    >
                      <option *ngFor="let month of mesi; let i = index" [value]="i + 1">
                        {{ month.mese }}
                      </option>
                    </select>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label for="annoSelect">Anno:</label>
                    <select
                      (change)="onAnnoSelectChange($event)"
                      class="form-select"
                      aria-label="Default select example"
                      id="annoSelect"
                      [(ngModel)]="selectedAnno"
                      name="anno"
                    >
                      <option *ngFor="let year of anni" [value]="year">
                        {{ year }}
                      </option>
                    </select>
                  </div>
                </div>
                <div class="col-md-4">
                  <label for="getRapportino">Azioni</label><br />
                  <button
                    mat-mini-fab
                    color="primary"
                    (click)="getAllRapportiniNonFreezati()"
                    [disabled]="selectedMese == null || selectedAnno == null">
                    <i class="fa fa-print" aria-hidden="true"></i>
                  </button>
                </div>
              </div>
            </div>
            <br />
          </form>
        </mat-card>

      </div>
     </div>
     <br>
     <div class="row"  *ngIf="getAllRapportiniNotFreezeCorretto">
      <div class="col-12">
        <mat-card>
         <mat-card-title>
          <h1>Rapportini da controllare ( {{elencoRapportiniNonFreezati.length}} ) </h1>
         </mat-card-title>
         <mat-card-content>

          <br>
          <mat-expansion-panel>
            <mat-expansion-panel-header (click)="mostraFiltriFreeze = !mostraFiltriFreeze">

              {{ mostraFiltriFreeze ? 'Nascondi filtri' : 'Mostra filtri' }}
            </mat-expansion-panel-header>

            <ng-template matExpansionPanelContent>
              <div *ngIf="mostraFiltriFreeze">
                <form [formGroup]="filterAnagraficaDto">
                  <div class="container-filtri">
                    <div formGroupName="anagrafica">
                      <p>Filtri disponibili per l'anagrafica:</p>
                      <div class="row">
                        <div class="col-md-3">
                          <div class="form-group">
                            <label for="nome">Nome</label>
                            <input  type="text" class="form-control"
                              id="anagrafica.nome" name="nome" placeholder="Inserire il nome." formControlName="nome">
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="form-group">
                            <label for="cognome">Cognome</label>
                            <input  type="text" class="form-control"
                              id="anagrafica.cognome" name="cognome" placeholder="Inserire il cognome."
                              formControlName="cognome">
                          </div>
                        </div>
                        <!-- <div class="col-md-1">
                          <div class="form-group">
                            <label for="attivo">Attivo</label> <br>
                            <input  type="checkbox" class="form-check-input"
                              style="border: 1px solid black;" id="anagrafica.attivo" name="attivo"
                              (change)="onChangeAttivo($event)" formControlName="attivo" checked>

                          </div>
                        </div> -->
                        <div class="col-md-2">
                          <div class="form-group">
                            <label for="attivo">Attesa lavori</label> <br>
                            <input  type="checkbox" class="form-check-input"
                              style="border: 1px solid black;" id="anagrafica.attesaLavori" name="attesaLavori"
                              formControlName="attesaLavori">
                          </div>
                        </div>
                        <div class="col-3">
                          <label for="filter-Tipo Azienda">Nome azienda</label>
                          <div class="form-group" formGroupName="tipoAzienda">
                            <select  class="form-select"
                              aria-label="Default select example" id="anagrafica.tipoAzienda.id" formControlName="id">
                              <option value="" selected>--Nessuna selezione--</option>
                              <option *ngFor="let tipoAzienda of tipiAziende" [value]="tipoAzienda.id">
                                {{ tipoAzienda.descrizione }}
                              </option>
                            </select>
                          </div>
                        </div>
                        <div class="col-md-3" formGroupName="tipoCanaleReclutamento">
                          <div class="form-group">
                            <label for="filter-tipoCanaleReclutamento">Canale reclutamento</label>
                            <select  class="form-select"
                              aria-label="Default select example" id="anagrafica.tipoCanaleReclutamento.id"
                              formControlName="id">
                              <option value="">--nessuna selezione--</option>
                              <option *ngFor="let tipoCanaleReclutamento of tipologicaCanaliReclutamento"
                                [value]="tipoCanaleReclutamento.id">
                                {{ tipoCanaleReclutamento.descrizione }}
                              </option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                    <br>
                    <br>
                    <div formGroupName="contratto">
                      <p>Filtri disponibili per il contratto:</p>
                      <br>
                      <div class="row">
                        <div class="col-md-3">
                          <div formGroupName="tipoContratto">
                            <label for="filter-TipoContratto">Tipo Contratto</label>
                            <select  class="form-select"
                              aria-label="Default select example" id="contratto.tipoContratto.id" formControlName="id"
                              (change)="onTipoContrattoChange($event)">
                              <option value="">--nessuna selezione--</option>
                              <option *ngFor="let tipoContratto of tipiContratti" [value]="tipoContratto.id">
                                {{ tipoContratto.descrizione }}
                              </option>
                            </select>
                          </div>

                        </div>

                        <div class="col-md-3">
                          <div formGroupName="tipoCcnl">
                            <label for="tipoCcnl">CCNL</label>
                            <select  (change)="onChangeTipoContrattoValue($event)"
                              class="form-select" aria-label="Default select example" id="contratto.tipoCcnl.id"
                              formControlName="id">
                              <option value="">--nessuna selezione--</option>
                              <option *ngFor="let contrattiNazionale of tipiCcnl" [value]="contrattiNazionale.id">
                                {{ contrattiNazionale.descrizione }}
                              </option>
                            </select>

                          </div>

                        </div>

                        <div class="col-md-3">
                          <div formGroupName="tipoLivelloContratto">
                            <label for="filter-LivelloContratto">Livello Contratto</label>
                            <select  class="form-select"
                              aria-label="Default select example" id="contratto.tipoLivelloContratto.id" formControlName="id">
                              <option value="">--nessuna selezione--</option>
                              <option *ngFor="let livello of elencoLivelliCCNL" [value]="livello.id">
                                {{ livello.livello }}
                              </option>
                            </select>
                          </div>
                        </div>

                        <div class="col-md-3" formGroupName="tipoAzienda">
                          <label for="tipoAzienda">Nome Azienda</label>
                          <select class="form-select"
                            aria-label="Default select example" id="contratto.tipoAzienda.id" formControlName="id"
                            type="number">
                            <option value="">--nessuna selezione--</option>
                            <option *ngFor="let tipoAzienda of tipiAziende" [value]="tipoAzienda.id">
                              {{ tipoAzienda.descrizione }}
                            </option>
                          </select>
                        </div>
                      </div>
                      <br>
                      <div class="row">
                        <div class="col-4">
                          <div class="form-group">
                            <label for="ralAnnua">RAL Annua</label>
                            <input  type="text" id="contratto.ralAnnua"
                              class="form-control" name="ralAnnua" formControlName="ralAnnua"
                              placeholder="Inserire RAL annua">
                          </div>
                        </div>
                        <!-- <div class="col-4">
                          <div class="form-group">
                            <label for="dataAssunzione">Data assunzione</label>
                            <input  type="date" id="contratto.dataAssunzione"
                              class="form-control" name="dataAssunzione" formControlName="dataAssunzione"
                              placeholder="Inserire data assunzione">
                          </div>
                        </div> -->
                        <!-- <div class="col-4" >
                          <div class="form-group">
                            <label for="dataFineRapporto">Data fine rapporto</label>
                            <input  type="date" id="contratto.dataFineRapporto"
                              class="form-control" name="dataFineRapporto" formControlName="dataFineRapporto"
                              placeholder="Inserire data fine rapporto">
                          </div>
                        </div> -->
                      </div>
                      <br>

                    </div>
                    <br>
                    <br>
                    <div class="row">
                      <p>Filtri per commesse</p>
                      <div class="col-3">
                        <div formArrayName="commesse">
                          <div *ngFor="let commessa of commesse.controls; let i = index">
                            <div [formGroupName]="i">
                              <div class="form-group" formGroupName="tipoAziendaCliente">
                                <label for="aziendaCliente">Azienda cliente</label>
                                <select (change)="onChangeAziendaCliente($event)" class="form-select"
                                aria-label="Default select example" id="commesse.tipoAziendaCliente.id" formControlName="id">
                                <option value="">--nessuna selezione--</option>
                                <option *ngFor="let aziendaCliente of aziendeClienti" [value]="aziendaCliente.id">
                                  {{ aziendaCliente.descrizione }}
                                </option>
                              </select>

                              </div>
                            </div>
                          </div>
                        </div>

                      </div>
                    </div>

                    <div class="row">
                      <div class="col-12" style="margin: auto; text-align: center;">
                        <button class="btn btn-success" (click)="filterListNotFreeze(filterAnagraficaDto.value)">Cerca <i
                            class="fa fa-search"></i> </button> &nbsp;
                        <button class="btn btn-info" (click)="reset()">Annulla filtri<i class="fa fa-undo"></i> </button>
                      </div>
                    </div>

                  </div>
                </form>
              </div>
            </ng-template>
          </mat-expansion-panel>
          <br>

          <table class="table table-striped table-bordered" id="table-rapportini">
            <thead>
              <tr>
                <th>
                  <button *ngIf="!tutteLeRigheSelezionate" mat-mini-fab color="primary" matTooltip="Seleziona tutti" (click)="toggleSelezione()">
                   <i class="fa fa-check" ></i>
                  </button>
                  <button mat-mini-fab color="primary" *ngIf="tutteLeRigheSelezionate" matTooltip="Deseleziona tutti" (click)="toggleSelezione()">
                   <i class="fa fa-close" ></i>
                  </button>
                </th>
                <th>Ruolo</th>
                <th>Nominativo</th>
                <th>Codice fiscale</th>
                <th>Cellulare privato</th>
                <th>Mail aziendale</th>
                <th>Stato rapportino</th>
                <th>Azioni</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let rapportinoNonFreezato of pageData; let i = index">
                <td>
                  <input
                    type="checkbox" [disabled]="rapportinoNonFreezato.anagrafica.checkInviato"
                    [(ngModel)]="rapportinoNonFreezato.rowSelected"
                    (change)="selezionaRiga(rapportinoNonFreezato)"
                  />
                </td>
                <td>{{ rapportinoNonFreezato.ruolo.descrizione | titlecase }}</td>
                <td>{{ rapportinoNonFreezato.anagrafica.nome | titlecase }} {{ rapportinoNonFreezato.anagrafica.cognome | titlecase }} <i [routerLink]="['/dettaglio-anagrafica/', rapportinoNonFreezato.anagrafica.id]" class="fa fa-info-circle" ></i> </td>
                <td>{{ rapportinoNonFreezato.anagrafica.codiceFiscale | uppercase }}</td>
                <td>{{ rapportinoNonFreezato.anagrafica.cellularePrivato ? rapportinoNonFreezato.anagrafica.cellularePrivato : 'Dato non inserito' }}</td>
                <td>{{ rapportinoNonFreezato.anagrafica.mailAziendale }}</td>
                <td *ngIf="rapportinoNonFreezato.anagrafica.checkInviato">
                  Inviato, da controllare
                  <button mat-mini-fab color="accent" (click)="onChangecheckFreeze(true, rapportinoNonFreezato.anagrafica.codiceFiscale, rapportinoNonFreezato.anagrafica.id, selectedAnno, selectedMese)" matTooltip="Imposta come 'CONTROLLATO'"> <i class="fa fa-lock"></i></button>
                </td>
                <td *ngIf="!rapportinoNonFreezato.anagrafica.checkInviato">
                  Non inviato
                  <button mat-mini-fab color="warn" (click)="sollecita(rapportinoNonFreezato.anagrafica.mailAziendale)" matTooltip="Sollecita {{ rapportinoNonFreezato.anagrafica.nome }} {{ rapportinoNonFreezato.anagrafica.cognome }}"> <i class="fa fa-envelope" aria-hidden="true"></i></button>
                </td>
                <td>
                  <button [disabled]="!rapportinoNonFreezato.anagrafica.checkInviato" mat-fab color="primary" (click)="          getRapportino(rapportinoNonFreezato.anagrafica.id, rapportinoNonFreezato.anagrafica.nome, rapportinoNonFreezato.anagrafica.cognome, rapportinoNonFreezato.anagrafica.codiceFiscale, selectedMese, selectedAnno)">
                    <mat-icon>info</mat-icon>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>


          <div class="pagination">
            <ul>
              <li [class.disabled]="currentPage === 1" (click)="goToPage(currentPage - 1)">
                <span> <i class="fa fa-arrow-left"></i> </span>
              </li>
              <li *ngFor="let page of getPaginationArray()" [class.active]="currentPage === page"
                (click)="goToPage(page)">
                <span>{{ page }}</span>
              </li>
              <li [class.disabled]="currentPage === getTotalPages()" (click)="goToPage(currentPage + 1)">
                <span> <i class="fa fa-arrow-right"></i> </span>
              </li>
              <li>
                <select name="itemsPerPage" id="itemsPerPage" class="form-select" (change)="onChaneItemsPerPage($event)" [(ngModel)]="itemsPerPage">
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="100">100</option>
                </select>
              </li>
            </ul>
          </div>
         </mat-card-content>
        </mat-card>
        <br><br><br>
      </div>
     </div>
     <br>
     <div class="row"  *ngIf="getAllRapportiniNotFreezeCorretto">
      <div class="col-12">
        <mat-card>
          <h1>Rapportini controllati ( {{elencoRapportiniFreezati.length}} ) </h1>
          <div class="container">
            <div class="row"  style="margin: auto; text-align: center;">
              <div class="col-6"  style="margin: auto; text-align: center;">
                <mat-card style="padding:15px;">
                  <form>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="form-group">
                          <label for="meseSelect">Mese:</label>
                          <select
                            (change)="onMeseSelectChange($event)"
                            class="form-select"
                            aria-label="Default select example"
                            id="meseSelect"
                            [(ngModel)]="selectedMeseRapportino"
                            name="mese"
                          >
                            <option *ngFor="let month of mesi; let i = index" [value]="i + 1">
                              {{ month.mese }}
                            </option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="form-group">
                          <label for="annoSelect">Anno:</label>
                          <select
                            (change)="onAnnoSelectChange($event)"
                            class="form-select"
                            aria-label="Default select example"
                            id="annoSelect"
                            [(ngModel)]="selectedAnnoRapportino"
                            name="anno"
                          >
                            <option *ngFor="let year of anni" [value]="year">
                              {{ year }}
                            </option>
                          </select>
                        </div>
                      </div>

                      <div class="col-md-4">
                        <label for="azioni">Azioni</label> <br>
                        <button mat-mini-fab color="primary" (click)="getAllRapportiniFreezati()">  <i class="fa fa-print" aria-hidden="true"></i></button>
                        &nbsp;
                        <button
                        mat-mini-fab
                        color="primary"
                        (click)="ExportCSV()"
                        [disabled]="selectedMeseRapportino == null || selectedAnnoRapportino == null || elencoRapportiniFreezati.length<1 "
                      >
                        <i class="fa fa-file" aria-hidden="true"></i>
                      </button>
                      </div>
                    </div>
                    <br />
                  </form>
                </mat-card>

              </div>
            </div>
          </div>

         <mat-card-content>
          <br>
          <mat-expansion-panel>
            <mat-expansion-panel-header (click)="mostraFiltriNotFreeze = !mostraFiltriNotFreeze">

              {{ mostraFiltriNotFreeze ? 'Nascondi filtri' : 'Mostra filtri' }}
            </mat-expansion-panel-header>

            <ng-template matExpansionPanelContent>
              <div *ngIf="mostraFiltriNotFreeze">
                <form [formGroup]="filterAnagraficaDto">
                  <div class="container-filtri">
                    <div formGroupName="anagrafica">
                      <p>Filtri disponibili per l'anagrafica:</p>
                      <div class="row">
                        <div class="col-md-3">
                          <div class="form-group">
                            <label for="nome">Nome</label>
                            <input  type="text" class="form-control"
                              id="anagrafica.nome" name="nome" placeholder="Inserire il nome." formControlName="nome">
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="form-group">
                            <label for="cognome">Cognome</label>
                            <input  type="text" class="form-control"
                              id="anagrafica.cognome" name="cognome" placeholder="Inserire il cognome."
                              formControlName="cognome">
                          </div>
                        </div>
                        <div class="col-md-3" formGroupName="tipoCanaleReclutamento">
                          <div class="form-group">
                            <label for="filter-tipoCanaleReclutamento">Canale reclutamento</label>
                            <select  class="form-select"
                              aria-label="Default select example" id="anagrafica.tipoCanaleReclutamento.id"
                              formControlName="id">
                              <option value="">--nessuna selezione--</option>
                              <option *ngFor="let tipoCanaleReclutamento of tipologicaCanaliReclutamento"
                                [value]="tipoCanaleReclutamento.id">
                                {{ tipoCanaleReclutamento.descrizione }}
                              </option>
                            </select>
                          </div>
                        </div>
                        <!-- <div class="col-md-1">
                          <div class="form-group">
                            <label for="attivo">Attivo</label> <br>
                            <input  type="checkbox" class="form-check-input"
                              style="border: 1px solid black;" id="anagrafica.attivo" name="attivo"
                              (change)="onChangeAttivo($event)" formControlName="attivo" checked>

                          </div>
                        </div> -->
                        <div class="col-md-2">
                          <div class="form-group">
                            <label for="attivo">Attesa lavori</label> <br>
                            <input  type="checkbox" class="form-check-input"
                              style="border: 1px solid black;" id="anagrafica.attesaLavori" name="attesaLavori"
                              formControlName="attesaLavori">
                          </div>
                        </div>
                        <div class="col-3">
                          <label for="filter-Tipo Azienda">Nome azienda</label>
                          <div class="form-group" formGroupName="tipoAzienda">
                            <select  class="form-select"
                              aria-label="Default select example" id="anagrafica.tipoAzienda.id" formControlName="id">
                              <option value="" selected>--Nessuna selezione--</option>
                              <option *ngFor="let tipoAzienda of tipiAziende" [value]="tipoAzienda.id">
                                {{ tipoAzienda.descrizione }}
                              </option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                    <br>
                    <br>
                    <div formGroupName="contratto">
                      <p>Filtri disponibili per il contratto:</p>
                      <br>
                      <div class="row">
                        <div class="col-md-3">
                          <div formGroupName="tipoContratto">
                            <label for="filter-TipoContratto">Tipo Contratto</label>
                            <select  class="form-select"
                              aria-label="Default select example" id="contratto.tipoContratto.id" formControlName="id"
                              (change)="onTipoContrattoChange($event)">
                              <option value="">--nessuna selezione--</option>
                              <option *ngFor="let tipoContratto of tipiContratti" [value]="tipoContratto.id">
                                {{ tipoContratto.descrizione }}
                              </option>
                            </select>
                          </div>

                        </div>

                        <div class="col-md-3">
                          <div formGroupName="tipoCcnl">
                            <label for="tipoCcnl">CCNL</label>
                            <select  (change)="onChangeTipoContrattoValue($event)"
                              class="form-select" aria-label="Default select example" id="contratto.tipoCcnl.id"
                              formControlName="id">
                              <option value="">--nessuna selezione--</option>
                              <option *ngFor="let contrattiNazionale of tipiCcnl" [value]="contrattiNazionale.id">
                                {{ contrattiNazionale.descrizione }}
                              </option>
                            </select>

                          </div>



                        </div>

                        <div class="col-md-3">
                          <div formGroupName="tipoLivelloContratto">
                            <label for="filter-LivelloContratto">Livello Contratto</label>
                            <select  class="form-select"
                              aria-label="Default select example" id="contratto.tipoLivelloContratto.id" formControlName="id">
                              <option value="">--nessuna selezione--</option>
                              <option *ngFor="let livello of elencoLivelliCCNL" [value]="livello.id">
                                {{ livello.livello }}
                              </option>
                            </select>
                          </div>
                        </div>

                        <div class="col-md-3" formGroupName="tipoAzienda">
                          <label for="tipoAzienda">Nome Azienda</label>
                          <select class="form-select"
                            aria-label="Default select example" id="contratto.tipoAzienda.id" formControlName="id"
                            type="number">
                            <option value="">--nessuna selezione--</option>
                            <option *ngFor="let tipoAzienda of tipiAziende" [value]="tipoAzienda.id">
                              {{ tipoAzienda.descrizione }}
                            </option>
                          </select>
                        </div>
                      </div>
                      <br>
                      <div class="row">
                        <div class="col-4">
                          <div class="form-group">
                            <label for="ralAnnua">RAL Annua</label>
                            <input  type="text" id="contratto.ralAnnua"
                              class="form-control" name="ralAnnua" formControlName="ralAnnua"
                              placeholder="Inserire RAL annua">
                          </div>
                        </div>
                        <!-- <div class="col-4">
                          <div class="form-group">
                            <label for="dataAssunzione">Data assunzione</label>
                            <input  type="date" id="contratto.dataAssunzione"
                              class="form-control" name="dataAssunzione" formControlName="dataAssunzione"
                              placeholder="Inserire data assunzione">
                          </div>
                        </div> -->
                        <!-- <div class="col-4">
                          <div class="form-group">
                            <label for="dataFineRapporto">Data fine rapporto</label>
                            <input  type="date" id="contratto.dataFineRapporto"
                              class="form-control" name="dataFineRapporto" formControlName="dataFineRapporto"
                              placeholder="Inserire data fine rapporto">
                          </div>
                        </div> -->

                      </div>
                      <br>

                    </div>
                    <br>
                    <br>
                    <div class="row">
                      <p>Filtri per commesse</p>
                      <div class="col-3">
                        <div formArrayName="commesse">
                          <div *ngFor="let commessa of commesse.controls; let i = index">
                            <div [formGroupName]="i">
                              <label for="aziendaCliente">Azienda cliente</label>
                              <div class="form-group" formGroupName="tipoAziendaCliente">
                                <select (change)="onChangeAziendaCliente($event)" class="form-select"
                                aria-label="Default select example" id="commesse.tipoAziendaCliente.id" formControlName="id">
                                <option value="">--nessuna selezione--</option>
                                <option *ngFor="let aziendaCliente of aziendeClienti" [value]="aziendaCliente.id">
                                  {{ aziendaCliente.descrizione }}
                                </option>
                              </select>

                              </div>
                            </div>
                          </div>
                        </div>

                      </div>
                    </div>

                    <div class="row">
                      <div class="col-12" style="margin: auto; text-align: center;">
                        <button class="btn btn-success" (click)="filterListFreeze(filterAnagraficaDto.value)">Cerca <i
                            class="fa fa-search"></i> </button> &nbsp;
                        <button class="btn btn-info" (click)="reset()">Annulla filtri<i class="fa fa-undo"></i> </button>
                      </div>
                    </div>

                  </div>
                </form>
              </div>
            </ng-template>
          </mat-expansion-panel>
          <br>
          <table class="table table-striped table-bordered"  id="table-rapportini" >
            <thead>
              <tr>
                <th>Ruolo</th>
                <th>Nominativo</th>
                <th>Codice fiscale</th>
                <th>Cellulare privato</th>
                <th>Mail aziendale</th>
                <th>Stato rapportino</th>
                <th>Azioni</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let rapportinoFreezato of pageData2; let i=index" >
                <td>{{rapportinoFreezato.ruolo.descrizione |titlecase }}</td>
                <td>{{rapportinoFreezato.anagrafica.nome |titlecase}}  {{rapportinoFreezato.anagrafica.cognome |titlecase}}</td>
                <td>{{rapportinoFreezato.anagrafica.codiceFiscale |uppercase}}</td>
                <td>{{rapportinoFreezato.anagrafica.cellularePrivato ? rapportinoFreezato.anagrafica.cellularePrivato : 'Dato non insrito'}}</td>
                <td>{{rapportinoFreezato.anagrafica.mailAziendale}}</td>
                <td >Controllato  </td>
                <td>
                  <button (click)="onChangecheckFreeze( false, rapportinoFreezato.anagrafica.codiceFiscale, rapportinoFreezato.anagrafica.id,selectedAnno, selectedMese)" mat-mini-fab color="warn" matTooltip="Rimuovi dalla lista dei rapportini controllati"> <i class="fa fa-minus" ></i> </button>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="pagination">
            <ul>
              <li [class.disabled]="currentPage2 === 1" (click)="goToPage2(currentPage2 - 1)">
                <span> <i class="fa fa-arrow-left"></i> </span>
              </li>
              <li *ngFor="let page of getPaginationArray2()" [class.active]="currentPage2 === page"
                (click)="goToPage2(page)">
                <span>{{ page }}</span>
              </li>
              <li [class.disabled]="currentPage2 === getTotalPages2()" (click)="goToPage2(currentPage2 + 1)">
                <span> <i class="fa fa-arrow-right"></i> </span>
              </li>
              <li>
                <select name="itemsPerPage" id="itemsPerPage" class="form-select" (change)="onChangeItemsPerPageFreeze($event)" [(ngModel)]="itemsPerPage2">
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="100">100</option>
                </select>
              </li>
            </ul>
          </div>
         </mat-card-content>
        </mat-card>
        <br><br><br>
      </div>
     </div>
    <div id="finePagina"></div>
  </div>
  <div class="container-fluid" *ngIf="ruolo==='DIPENDENTE'" [class.dark-mode]="themeService.isDarkModeEnabled()">
    <div class="row">
      <div class="col-12">
        <br>
        <mat-card style="text-align: center;">
          <h1><img src="../../../../assets/images/danger.png" alt="Logo Sincrono"></h1>
          <h1>Non hai i permessi per accedere a questa sezione.</h1>
           <a mat-stroked-button [routerLink]="['/home']" target="_blank">Vai alla home.</a>
        </mat-card>
      </div>
    </div>
  </div>
  <footer>
    <div class="footer">
      <div class="contain">
      <div class="col">
        <h2>Sito web</h2>
        <ul>
          <li> <a href="https://www.sincrono.it/" target="_blank"> <img class="logo-image" width="40" height="40" src="../../../../assets/images/logo.jpeg" alt="Logo"></a> </li>
        </ul>
      </div>
      <div class="col">
        <h2>Social</h2>
        <ul>
          <li>
            <a href="https://www.linkedin.com/company/gruppo-sincrono/mycompany/" target="_blank" class="social-icon"><i class="fab fa-linkedin"></i></a>
            <a href="https://www.facebook.com/g.sincrono" class="social-icon" target="_blank"><i class="fab fa-facebook"></i></a>
            <a href="https://www.instagram.com/grupposincrono?igshid=OGQ5ZDc2ODk2ZA==" class="social-icon" target="_blank"><i class="fab fa-instagram"></i></a>
            <a href="https://www.sincrono.it/#pinterest" class="social-icon" target="_blank"><i class="fab fa-pinterest"></i></a>
          </li>
        </ul>
      </div>

      <div class="col">
        <h2>Contatti</h2>
        <ul>
          <li> <b>Tel:</b> 06 7101227</li>
          <li> <b>Fax:</b> 06 89716493</li>
          <li> <b>P.IVA:</b> 14651701006</li>
          <li matTooltip="Invia il tuo CV" > <b>Lavora con noi: </b><span [innerHTML]="'cv@sincrono.it'"></span> </li>
        </ul>
      </div>
      <div class="col address">
        <h2>Indirizzo </h2>
        <ul>
          <li> <b>Indirizzo:</b> Via Vinicio Cortese 147/F - 00128 Roma (RM) - Lazio, Italia</li>
          <li> <b>Sede legale:</b> Via Isole del Capoverde 310, 00121 (Roma) (RM) - Lazio, Italia</li>
      </ul>
      </div>
      <div class="col">
        <h2>Tutti i diritti riservati</h2>
      </div>
      <div class="col">
        <h2>Tempo di sessione:</h2>
        <ul>
          <li><p>{{ formatTime(tokenExpirationTime) }}</p></li>
        </ul>
      </div>
    <div class="clearfix"></div>
    </div>
    </div>
    </footer>
</body>

</html>
